---
# Rolle: setup_rhel_pxe_structure
# Erstellt aus einem RHEL-ISO die Verzeichnisstruktur auf Webserver und TFTP-Server
# (Repo-Verzeichnis, TFTP-Basis, GRUB2 für ppc64le, Kernel/Initrd).
# Keine LPAR-spezifischen Schritte.

# =============================================================================
# RHEL & ISO
# =============================================================================
setup_rhel_pxe_structure_rhel_version: "9.6"
setup_rhel_pxe_structure_rhel_major_version: "{{ setup_rhel_pxe_structure_rhel_version.split('.')[0] }}"
# Pfad zum RHEL-ISO auf dem Kickstart-Server (ppc64le)
setup_rhel_pxe_structure_iso_path: "/root/rhel-{{ setup_rhel_pxe_structure_rhel_version }}-ppc64le-dvd.iso"

# =============================================================================
# Verzeichnisse
# =============================================================================
setup_rhel_pxe_structure_kickstart_base_dir: "/var/www/html/kickstart"
setup_rhel_pxe_structure_tftp_root: "/var/lib/tftpboot"
setup_rhel_pxe_structure_iso_mount_point: "/mnt/rhel-iso"
# Repo unter HTTP (z. B. /var/www/html/kickstart/rhel9)
setup_rhel_pxe_structure_repo_dir: "{{ setup_rhel_pxe_structure_kickstart_base_dir }}/rhel{{ setup_rhel_pxe_structure_rhel_major_version }}"

# Optional: generische grub.cfg unter tftp_root/grub2-ppc64le anlegen
setup_rhel_pxe_structure_grub_generic: false
setup_rhel_pxe_structure_kickstart_server_ip: "{{ ansible_default_ipv4.address | default('127.0.0.1') }}"

# =============================================================================
# Optionale Prüfung: ISO muss existieren, um zu mounten/syncen
# =============================================================================
setup_rhel_pxe_structure_require_iso: true
